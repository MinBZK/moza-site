<!doctype html><html lang=nl><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>profielservice | MijnOverheid Zakelijk</title><meta name=description content="Bij MijnOverheid Zakelijk staan ondernemers centraal. Elk uur minder aan gedoe, is een uur meer ondernemen. We zorgen voor overzicht en makkelijk zaken doen. Met elkaar bouwen we zo aan nieuwe digitale snelwegen."><link rel=icon href=/moza-site/preview/pr-34/favicon.ico type=image/x-icon><link rel=stylesheet href=/moza-site/preview/pr-34/css/style.d7b5263c47ca3ec112794ed40ce533e2.css><script src=/moza-site/preview/pr-34/js/bundle.f708e6c53039c684a38ddc8d9c70bc8a.js defer></script></head><body><a href=#main-content class=skip-link>Ga naar de inhoud</a><header><div class=banner><div class=site-info><p class=title><a href=/>MijnOverheid Zakelijk</a></p><p class=tagline>Makkelijk zaken doen met de overheid</p></div><div class=site-logo><a href=/ tabindex=-1 aria-hidden=true><img src=/moza-site/preview/pr-34/images/logo-rijksoverheid.svg alt="Logo Rijksoverheid"></a></div></div><nav class=navbar aria-label=Hoofdnavigatie><a href=/ class=title>MijnOverheid Zakelijk</a><div class=menu><ul><li><a href=/moza-site/preview/pr-34/ data-text=Home>Home</a></li><li><a href=/moza-site/preview/pr-34/over-moza/ data-text="Over MOZa">Over MOZa</a></li><li><a href=/moza-site/preview/pr-34/actueel/ data-text=Actueel>Actueel</a></li><li><a href=/moza-site/preview/pr-34/onderwerpen/ data-text=Onderwerpen>Onderwerpen</a></li><li><a href=/moza-site/preview/pr-34/documentatie/ data-text=Documentatie class=active aria-current=page>Documentatie</a></li><li><a href=/moza-site/preview/pr-34/contact/ data-text=Contact>Contact</a></li></ul><ul class=navbar-right><li><button class=search-trigger aria-label=Zoeken aria-haspopup=dialog><svg class="search-icon" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M9 3.5a5.5 5.5.0 100 11 5.5 5.5.0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75.0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"/></svg><span class=search-trigger-text>Zoeken...</span>
<kbd class=search-shortcut>/</kbd></button></li><li><button id=theme-toggle class=theme-toggle aria-label="Toggle theme"><svg class="sun" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364-6.364-.707.707M6.343 17.657l-.707.707m12.728.0-.707-.707M6.343 6.343l-.707-.707M12 8a4 4 0 100 8 4 4 0 000-8z"/></svg><svg class="moon" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg></button></li></ul></div><button class="search-trigger mobile-search" aria-label=Zoeken aria-haspopup=dialog><svg class="search-icon" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M9 3.5a5.5 5.5.0 100 11 5.5 5.5.0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75.0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"/></svg></button>
<button class="theme-toggle mobile-theme" aria-label="Wissel thema" onclick='document.getElementById("theme-toggle").click()'><svg class="sun" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364-6.364-.707.707M6.343 17.657l-.707.707m12.728.0-.707-.707M6.343 6.343l-.707-.707M12 8a4 4 0 100 8 4 4 0 000-8z"/></svg><svg class="moon" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg></button>
<button class=toggle aria-label="Menu openen" aria-expanded=false aria-controls=mobile-menu onclick='const expanded=this.getAttribute("aria-expanded")==="false";this.setAttribute("aria-expanded",expanded),this.setAttribute("aria-label",expanded?"Menu sluiten":"Menu openen")'><svg class="menu-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M4 6h16M4 12h16M4 18h16"/></svg></button><div id=mobile-menu class=mobile role=navigation aria-label="Mobiel menu"><ul><li><a href=/moza-site/preview/pr-34/>Home</a></li><li><a href=/moza-site/preview/pr-34/over-moza/>Over MOZa</a></li><li><a href=/moza-site/preview/pr-34/actueel/>Actueel</a></li><li><a href=/moza-site/preview/pr-34/onderwerpen/>Onderwerpen</a></li><li><a href=/moza-site/preview/pr-34/documentatie/ class=active aria-current=page>Documentatie</a></li><li><a href=/moza-site/preview/pr-34/contact/>Contact</a></li><li class=mobile-theme-toggle><button class=theme-toggle aria-label="Toggle theme" onclick='document.getElementById("theme-toggle").click()'>
<span class=sun>Light Mode</span>
<span class=moon>Dark Mode</span></button></li></ul></div></nav><nav class=breadcrumb aria-label=Breadcrumb><ol><li><a href=/>Home</a>
<span class=separator aria-hidden=true></span></li><li><a href=/moza-site/preview/pr-34/documentatie/>Documentatie</a>
<span class=separator aria-hidden=true></span></li><li><span class=current aria-current=page>profielservice</span></li></ol></nav></header><main id=main-content><article class=docs><h1>Profielservice</h1><div class=content><blockquote class=quote><table><thead><tr><th><strong>Status</strong></th><th>Conceptversie</th></tr></thead><tbody><tr><td>Laatste update</td><td>21-11-2025</td></tr><tr><td>Auteur</td><td>Robin Alderliesten</td></tr></tbody></table></blockquote><h2 id=visie>Visie</h2><p>De Profiel Service stelt burgers en ondernemers in staat om op één vertrouwde plek hun contactgegevens en communicatievoorkeuren te beheren, en biedt overheidsinstanties via federatieve koppelingen veilige, actuele en herbruikbare profielinformatie voor persoonlijke en efficiënte dienstverlening.</p><h2 id=wat-is-de-profiel-service>Wat is de Profiel Service</h2><p>De Profiel Service vormt een bouwsteen binnen de digitale overheid. Het biedt burgers én ondernemers één centrale plek waar zij hun contactgegevens en communicatievoorkeuren kunnen beheren. Overheidsorganisaties kunnen deze gegevens via gestandaardiseerde API’s opvragen en gebruiken om betrouwbaar, persoonlijk en efficiënt te communiceren — altijd met toestemming van de gebruiker.</p><p>Waar vandaag de dag veel contactgegevens versnipperd zijn opgeslagen in losse portalen en applicaties, brengt de Profiel Service dit samen in een centraal, goed beheerd register. Daarmee vormt het een solide basis voor federatieve dienstverlening: één betrouwbare bron die andere federatieve services ondersteunt met actuele en verifieerbare profielinformatie.</p><h2 id=waarom-een-profiel-service>Waarom een Profiel Service</h2><p>Voor burgers bestaat al de mogelijkheid om bepaalde gegevens te beheren via MijnOverheid, maar ondernemers vallen grotendeels buiten de boot. Zij moeten hun contactinformatie nog te vaak handmatig herhalen bij elke overheidsdienst. Ook is er geen centrale plek waar communicatievoorkeuren kunnen worden vastgelegd — zoals de voorkeur voor digitaal of post.</p><p>De Profiel Service lost dit op door:</p><ul><li>één betrouwbare bron van contact- en voorkeursgegevens te bieden,</li><li>overheidsbreed hergebruik mogelijk te maken,</li><li>burgers en ondernemers de regie te geven over hoe zij met de overheid communiceren.</li></ul><h2 id=doel-en-waarde>Doel en waarde</h2><p>De Profiel Service is bedoeld om:</p><ul><li><strong>Burgers en ondernemers</strong> controle te geven over hun profielgegevens en communicatievoorkeuren, op één vertrouwde plek.</li><li><strong>Overheidsorganisaties</strong> te voorzien van actuele en verifieerbare gegevens, rechtstreeks uit een centrale bron.</li><li><strong>De digitale overheid</strong> te versterken met een herbruikbare bouwsteen die past binnen de Generieke Digitale Infrastructuur (GDI).</li></ul><h3 id=functionele-doelstellingen>Functionele doelstellingen</h3><ul><li>Beheer van profielgegevens: e-mailadres, telefoonnummer, postadres etc. op een centrale plek</li><li>Instellen van contactvoorkeuren: bijvoorbeeld voorkeur voor digitaal of post, notificatiekanalen, etc.</li><li>Instellen van overige voorkeuren; denk aan weergaveinstellingen en overige sets van voorkeuren</li><li>Ondersteuning van meerdere authenticatiemiddelen: DigiD, eHerkenning, eIDAS</li><li>Koppeling met registers: KVK, BRP, BAG, gegevens bij de bron opvragen</li><li>Federatief delen: gegevens worden centraal opgeslagen en beschikbaar gesteld aan verifieerbare dienstverleners</li></ul><h3 id=strategische-doelstellingen>Strategische doelstellingen</h3><ul><li>Versterken van vertrouwen in digitale dienstverlening (conform de Generieke Digitale Infrastructuur (GDI))</li><li>Verlagen van administratieve lasten voor ondernemers</li><li>Verbeteren van &ldquo;omnichannel communicatie&rdquo; tussen overheid en gebruiker</li><li>Herbruikbaarheid van profieldata over meerdere overheidsdomeinen heen</li><li>Incrementele groei: klein beginnen en iteratief uitbreiden</li></ul><h2 id=benodigde-afspraken>Benodigde afspraken</h2><p>Om een centrale Profiel Service voor burgers en ondernemers neer te zetten is het noodzakelijk dat dienstverleners deze adopteren in hun eigen ecosystemen en MijnOmgevingen. Hiervoor werken we volgens de principes van het programma Generieke Digitale Infrastructuur (GDI). Dit betekent dat afspraken en standaarden worden neergezet en de Profiel Service als voorziening beschikbaar wordt gemaakt.</p><p>In de komende periode werken we aan het verzamelen van informatie en het beantwoorden van vragen die hierover onstaan bij de uitwerking.</p><h2 id=gefaseerde-ontwikkelstrategie>Gefaseerde ontwikkelstrategie</h2><p>De Profiel Service wordt stapsgewijs gerealiseerd, met een nadruk op eenvoud, hergebruik en federatieve samenwerking.</p><table><thead><tr><th>Fase</th><th>Beschrijving</th><th>Resultaat</th></tr></thead><tbody><tr><td>1. Basisprofiel</td><td>Eenvoudig profiel met e-mailadres, telefoonnummer, postadres en één algemene voorkeur.</td><td>Werkend MVP; eerste API’s; DigiD/eHerkenning/eIDAS; logging</td></tr><tr><td>2. Kanaalvoorkeuren</td><td>Ondersteuning voor kanaalspecifieke voorkeuren (e-mail, sms, etc.).</td><td>Omnichannel communicatie overheidsbreed ondersteund</td></tr><tr><td>3. Federatieve integratie</td><td>Integratie met bronregisters zoals KvK, BRP en BAG</td><td>Actuele, verifieerbare gegevens direct bij de bron opgehaald</td></tr><tr><td>4. Ecosysteemontwikkeling</td><td>Overheidsorganisaties sluiten aan via standaarden en API’s.</td><td>Overheidsbreed gedragen profielservice binnen de GDI</td></tr></tbody></table><h2 id=architectuur-en-uitgangspunten>Architectuur en uitgangspunten</h2><ul><li><strong>Centraal profielregister:</strong> één betrouwbare bron van waarheid voor contact- en voorkeursgegevens.</li><li><strong>Ondersteuning voor federatieve diensten:</strong> de Profiel Service zelf is centraal, maar stelt gegevens beschikbaar aan federatieve toepassingen.</li><li><strong>NeRDS</strong>: Ontwikkeling volgt Nederlandse Richtlijn Digitale Systemen (NeRDS).</li><li><strong>Open standaarden:</strong> API’s volgen NORA, NL GOV API Design Rules en GDI-richtlijnen.</li><li><strong>Federatieve identiteit:</strong> toegang via DigiD, eHerkenning en eIDAS.</li><li><strong>Privacy by design:</strong> minimale dataverwerking, transparantie en logging conform LDV.</li><li><strong>Data bij de bron:</strong> de Profiel Service als basisregister voor contactvoorkeuren</li></ul><h2 id=lange-termijn-visie>Lange termijn visie</h2><p>Op langere termijn groeit de Profiel Service uit tot een generieke bouwsteen binnen de GDI — een betrouwbare voorziening waarop iedere overheidsorganisatie kan aansluiten.</p><ul><li>Burgers en ondernemers hebben volledige regie over hun gegevens.</li><li>Overheidsorganisaties communiceren veilig en consistent met hun gebruikers.</li><li>De Profiel Service ondersteunt een breed palet aan diensten, zoals:<ul><li>MijnOverheid</li><li>MijnServices (VNG)</li><li>Digitaal Ondernemersplein</li><li>Notificatie- en berichtenservices (NotifyNL, BBO)</li><li>Alle MijnOmgevingen van overheidsdienstverleners.</li></ul></li></ul><h2 id=positionering-voor-stakeholders>Positionering voor stakeholders</h2><table><thead><tr><th>Stakeholder</th><th>Waarde</th></tr></thead><tbody><tr><td>Gebruikers (burger/ondernemer)</td><td>Eén plek voor profielbeheer en voorkeuren</td></tr><tr><td>Overheidsorganisaties</td><td>Betrouwbare bron van actuele contactgegevens</td></tr><tr><td>Architecten en beleidsmakers</td><td>GDI Bouwsteen en toekomstbestendig component</td></tr><tr><td>Ontwikkelaars en leveranciers</td><td>Eenduidige API&rsquo;s, herbruikbaar component</td></tr></tbody></table><h2 id=oproep-tot-samenwerking>Oproep tot samenwerking</h2><p>De ontwikkeling van de Profiel Service vraagt samenwerking tussen beleidsmakers, ontwerpers, ontwikkelaars en uitvoeringsorganisaties.<br>Alleen door gezamenlijk standaarden te ontwikkelen, adoptie te stimuleren en kennis te delen ontstaat een breed gedragen voorziening die écht waarde toevoegt.</p><p>Wij nodigen daarom alle overheidsorganisaties uit om mee te denken, mee te bouwen en mee te leren.<br>Samen maken we van de Profiel Service niet alleen een technische voorziening, maar een fundament voor betrouwbare, toegankelijke en toekomstbestendige digitale dienstverlening.</p><h2 id=documentatie--bronnen>Documentatie & Bronnen</h2><ul><li><strong><a href=https://mijnoverheidzakelijk.nl target=_blank rel="external noopener noreferrer">MijnOverheid Zakelijk startpagina</a></strong> - Meer informatie en documentatie over het programma MijnOverheid Zakelijk is te vinden via onze startpagina.</li><li><strong><a href=https://github.com/orgs/MinBZK/teams/mijnoverheid-zakelijk target=_blank rel="external noopener noreferrer">Profiel Service op GitHub</a></strong> - Onze oplossingen worden Open Source ontwikkeld en zijn te vinden op de Github van MinBZK</li></ul><h1 id=profiel-service>Profiel Service</h1><h2 id=context>Context</h2><p>Er bestaan al voorzieningen waarmee burgers gegevens kunnen beheren (zoals de MijnOverheid-instellingen), maar ondernemers vallen daar grotendeels buiten. Bovendien is de huidige inrichting vaak monolithisch en niet federatief; data wordt decentraal en niet herbruikbaar opgeslagen bij de dienstverleners.</p><h3 id=een-aantal-uitdagingen>Een aantal uitdagingen</h3><ul><li>Ondernemers moeten vaak opnieuw hun gegevens invullen bij elke overheidsdienst</li><li>Er is géén centrale plek waar contactgegevens en -voorkeuren beheerd of opgehaald kunnen worden</li><li>Er is onvoldoende inzicht over wie toegang heeft tot welke gegevens</li><li>Met name voor ondernemers zijn er nog geen voorzieningen beschikbaar en komen er ook niet binnenkort</li></ul><h3 id=doel>Doel</h3><p><strong>Burgers</strong> en <strong>ondernemers</strong> kunnen op één vertrouwde plek hun communicatievoorkeuren en contactgegevens opslaan.</p><p><strong>Overheidsorganisaties</strong> kunnen bij deze centrale service actuele en betrouwbare contactvoorkeuren en contactgegevens ophalen, o.a. voor het versturen van notificaties.</p><iframe id=structurizr-diagram-ProfielServiceContext src="/moza-site/preview/pr-34/diagrammen/index.html?iframe=structurizr-diagram-ProfielServiceContext#ProfielServiceContext" width=100% height=800px></iframe><p>De Profiel Service is een centraal register dat gebruikt kan worden in portalen of andere interactiecomponenten voor het ophalen van de voorkeuren van burgers en ondernemers.</p><p>De Profiel Service bevat persoons- en bedrijfsgegevens en die gebruikt kunnen worden voor de communicatie tussen de gebruiker en overheidsorganisaties. Dit zijn zowel contactgegevens (zoals e-mailadres en telefoonnummer) als voorkeuren waarover de communicatie tussen de gebruiker en de overheidsorganisatie plaatsvindt.</p><h2 id=functioneel-overzicht>Functioneel overzicht</h2><h3 id=inleiding>Inleiding</h3><p>Dit hoofdstuk bouwt voort op de context en visie en verwijst naar aanvullende documentatie en diagrammen.
Het biedt kort en duidelijk inzicht in wat de Profiel Service doet, voor wie het dat doet en hoe de belangrijkste informatiestromen lopen.</p><h3 id=overzicht>Overzicht</h3><p>De Profiel Service biedt één centrale voorziening waar burgers en ondernemers hun contactgegevens en communicatievoorkeuren kunnen beheren,
en waar overheidsorganisaties deze, met toestemming en volgens afspraken, betrouwbaar kunnen opvragen.
Daarmee ondersteunt de Profiel Service federatieve en herbruikbare digitale dienstverlening binnen de overheid.</p><p>Wat het systeem feitelijk doet, is het centraal opslaan en ontsluiten van profielgegeven/contactgegevens, voor burgers en ondernemers.
Belangrijke gebruikers en hun behoeften zijn:</p><ul><li>Burger/ondernemer: eigen profiel beheren (inzien, toevoegen, wijzigen, verwijderen), voorkeuren instellen en waar nodig gegevens verifiëren.</li><li>Dienstverlener/Vakapplicatie: via API’s profiel- en contactgegevens ophalen.</li></ul><p>Belangrijke leveranciers zijn:</p><ul><li>Identiteitsproviders (DigiD, eHerkenning, eIDas): verzorgen de authenticatie waarmee toegang tot het profiel mogelijk is.</li><li>De KvK, integratie met KvK voor verrijking en verificatie van data bij de bron waaronder api gebruik om identificaties (BSN & KvK) aan elkaar te koppelen.</li><li>Digitaal Ondernemersplein die noodzakelijk gaat zijn in het bijhouden van actuele updates over bijvoorbeeld subsidies of wetswijzigingen.</li></ul><h4 id=kernfunctionaliteiten-in-het-kort>Kernfunctionaliteiten in het kort:</h4><ul><li>Profiel inzien met overzicht van contactgegevens (e-mail, telefoon, postadres) en communicatievoorkeuren (bijv. kanaalvoorkeur, taal).</li><li>Profiel beheren: toevoegen, wijzigen en verwijderen van contactgegevens; instellen van voorkeuren (algemeen en dienstspecifiek/scope-gebaseerd); verifiëren van contactkanalen (bijv. via bevestigingsmail/sms; status vastleggen).</li><li>Profiel ophalen door dienstverleners: actuele contactgegevens en voorkeuren opvragen op basis van een partij-identificatie (bijv. KVK, BSN, RSIN), inclusief scope voor dienst/dienstverlener; inclusief verifieerbaarheidsindicatoren ontvangen.</li><li>Identificaties koppelen en beheren: vastleggen van BSN/KvK/RSIN/etc. en koppelen aan één partijprofiel.</li><li>Toegang verlenen aan dienstverleners conform afsprakenstelsel en autorisaties van het Federatieve Data Stelsel (FDS).</li><li>Logging en transparantie (conform <a href=https://www.logius.nl/onze-dienstverlening/gegevensuitwisseling/logboek-dataverwerkingen/wat-is-logboek-dataverwerkingen target=_blank rel="external noopener noreferrer">LDV</a>): registreren van relevante gebeurtenissen ten behoeve van inzage en troubleshooting.</li><li>Audit logging voor juridische doeleinde.</li></ul><h4 id=belangrijkste-processen-en-informatiestromen>Belangrijkste processen en informatiestromen:</h4><ol><li>Authenticatie en sessieopbouw – Inloggen via DigiD (burger/zzp&rsquo;er), eHerkenning (ondernemer) of eIDas (buitenlandse belanghebbende); autorisatie en scoping bepalen welk profiel en welke gegevens zichtbaar/bewerkbaar zijn. Flow verder uitgewerkt in 07-code-Aurthenticatie.</li></ol><p>In deze flowchart is te zien hoe de diverse inlogopties worden gebruikt en welke identificerende informatie wij dan aan de gebruiker kunnen koppelen.
<img src=./images/ArchitectuurProfielService/AuthenticatieFlowchart.png alt="Auth Flowchart" title="Auth Flowchart"></p><details><summary>Zie mermaid code</summary><pre><code>flowchart TD;
    %% Trigger
        TRIGGER([De ondernemer wilt zijn contactgegevens updaten])--&gt;S1;

    %% DigId scenario
        S1[Het systeem laat de inlog opties zien: 1. Digid, 2. eHerkenning, 3. eIDas als Burger 4. eIDas als Organisatie]--&gt;S2;
        S2[De ondernemer kiest Digid]--&gt;S3;
        S3[Het systeem met behulp van het BSN haalt hij de relevant KVK's op bij de KVK-BSN api.];
        S3--&gt;SUCCESS_DigId;

    %% eHerkenning scenario
        S1--&gt;EXT2a1;
        EXT2a1[De ondernemer kiest eHerkenning]--&gt;EXT2a2;
        EXT2a2[Het systeem haalt de KVK &amp; BSN uit de eHerkenning. Voor BSN komt die uit NIN &amp; NIN_TYPE.]--&gt;EXT2a3;
        EXT2a3[OPTIE: Het systeem gebruikt het BSN om de andere KVK's op te halen bij de KVK-BSN api??.];
        EXT2a2--&gt;SUCCESS_eHerkenning;
        EXT2a3--&gt;SUCCESS_eHerkenning;

    %% eIDas scenario
        S1--&gt;EXT3a1;
        EXT3a1[De ondernemer kiest eIDas Burger]--&gt;EXT3a2;
        EXT3a2[Het systeem haalt de Person Identifier, en optioneel Representative Person Identifier uit eIDas.];
        EXT3a2--&gt;SUCCESS_eIDas_Burger;

        S1--&gt;EXT4a1;
        EXT4a1[De ondernemer kiest eIDas Organisatie]--&gt;EXT4a2;
        EXT4a2[Het systeem haalt de Legal Person Identifier, en optioneel Legal Entity Identifier uit eIDas.];
        EXT4a2--&gt;SUCCESS_eIDas_Organisatie;

        SUCCESS_DigId([De ondernemer kan zijn contactgegevens updaten voor zichzelf en al zijn ondernemingen]);
        SUCCESS_eHerkenning([De ondernemer kan zijn contactgegevens updaten voor zichzelf en 1 onderneming]);
        SUCCESS_eIDas_Burger([De ondernemer kan zijn contactgegevens updaten voor deze eIDas Person Identifier]);
        SUCCESS_eIDas_Organisatie([De ondernemer kan zijn contactgegevens updaten voor deze eIDas Legal Person Identifier]);
</code></pre></details><ol start=2><li>Profiel inzien en beheren – Gebruiker bekijkt bestaande gegevens en voorkeuren en voert wijzigingen door. Zie sequentie diagrammen hierover in 07-code-ProfielBeheren en 08-data-sequentiediagrammen.</li></ol><p>In de onderstaande sequentiediagram is te zien hoe een gebruiker zijn profiel kan bekijken en bijwerken als hij inlogd met DigiD.
<img src=./images/ArchitectuurProfielService/SeqOndernemerProfiel.png alt="Sequentiediagram ondernemer bekijkt en update contactvoorkeuren" title="Sequentiediagram ondernemer bekijkt en update contactvoorkeuren"></p><details><summary>Zie mermaid code</summary><pre><code>sequenceDiagram
    actor Ondernemer
    participant MOZa as MOZa Portaal
    participant KvK as KvK
    participant Profiel as Profiel Service

    Ondernemer-&gt;&gt;MOZa: Logt in
    activate MOZa

    alt Als login via DigiD
        MOZa-&gt;&gt;KvK: Haal ondernemingen op voor BSN
        deactivate MOZa
        activate KvK
        KvK--&gt;&gt;MOZa: Geeft ondernemingen terug (KvK-nummers)
        deactivate KvK
        activate MOZa
    end

    MOZa-&gt;&gt;Ondernemer: Toon Profiel Pagina
    Ondernemer-&gt;&gt;MOZa: Opent pagina 'Contactvoorkeuren'

    MOZa-&gt;&gt;Profiel: GET contactvoorkeuren (BSN + KvK)
    deactivate MOZa
    activate Profiel
    Profiel--&gt;&gt;MOZa: Contactvoorkeuren terug
    deactivate Profiel
    activate MOZa

    MOZa-&gt;&gt;Ondernemer: Toon pagina 'Contactvoorkeuren'

    Ondernemer-&gt;&gt;MOZa: Past contactvoorkeur aan

    MOZa-&gt;&gt;Profiel: PATCH contactvoorkeur (BSN + KvK)
    deactivate MOZa
    activate Profiel
    Profiel--&gt;&gt;MOZa: Ok (voorkeur bijgewerkt)
    deactivate Profiel
    activate MOZa

    MOZa--&gt;&gt;Ondernemer: Toont bevestiging
    deactivate MOZa
</code></pre></details><ol start=3><li>Profiel bevragen door dienstverlener – Vakapplicaties (of OMC/dergelijks) halen via API contactgegevens/voorkeuren op. Scoping per dienst/dienstverlener bied focus en ondersteunt dataminimalisatie. Zie 08-data-sequentiediagrammen.</li></ol><p>Hier is te zien is een eenvoudige sequentie diagram hoe de dienstverlener de informatie zou ophalen, en bijvoorbeeld gebruikt op een persoon aan de hand daarvan een notificatie te versturen.</p><p><img src=./images/ArchitectuurProfielService/SeqDVBevraagdPSenNotificeert.png alt="Sequentiediagram dienstverlener bevraagd profielservice en notificeert" title="Sequentiediagram dienstverlener bevraagd profielservice en notificeert"></p><details><summary>Zie mermaid code</summary><pre><code>sequenceDiagram
  participant Dienstverlener@{&quot;type&quot; : &quot;collections&quot;}
  participant PS as Profiel Service
  participant NS as Notificatie Service
  actor BO as Burger of Ondernemer

  Dienstverlener -&gt;&gt; PS: Stuurt identificatienummer
  PS --&gt;&gt; Dienstverlener: Levert contactvoorkeuren
  Dienstverlener -&gt;&gt; NS: Stuurt inhoud notificatiebericht + voorkeurskanaal
  NS -&gt;&gt; BO: Stuurt bericht via voorkeurskanaal
  NS --&gt;&gt; Dienstverlener: Status aflevering (OK/NOK)
</code></pre></details>## Kwaliteitseisen<h3 id=inleiding-1>Inleiding</h3><p>Dit hoofdstuk vat de belangrijkste niet-functionele eisen (kwaliteitseisen) voor de Profiel Service samen.
De eisen zijn zo veel mogelijk SMART geformuleerd en sluiten aan op het functioneel overzicht en de context.
Waar relevant verwijzen we naar architectuurkeuzes in de ADR’s en ondersteunende documentatie.</p><h3 id=overzicht-1>Overzicht</h3><p>De onderstaande kwaliteitseisen zijn architectonisch significant en sturen ontwerp- en implementatiekeuzes:</p><ul><li>Beveiliging & Privacy (AVG, authenticatie/authorisatie, dataminimalisatie)</li><li>Beschikbaarheid & Continuïteit</li><li>Performance & Schaalbaarheid</li><li>Auditability & Logging (LDV)</li><li>Interoperabiliteit & Open Standaarden</li><li>Observeerbaarheid (monitoring, metrics, tracing)</li><li>Herstelbaarheid (back-up/restore, DR)</li></ul><p>Waar zaken bewust buiten scope vallen, is dit expliciet benoemd.</p><h4 id=beveiliging--privacy>Beveiliging & Privacy</h4><ul><li>Authenticatie: Via erkende federatieve identiteiten (DigiD, eHerkenning, eIDas) conform ADR 0006. Eisen: OIDC/OAuth 2.0 flows, tokens met beperkte scopes, token TTL ≤ 60 min; refresh alleen server-to-server waar passend. Meetbaar via IDP-config en token policies.</li><li>Autorisatie: scope-gebaseerd mogelijkheid (per dienst/dienstverlener) met dataminimalisatie. Alleen de minimaal opgevraagde attributen worden geleverd. Verplicht ‘least privilege’ op API-niveau & ontsloten via het FDS.</li><li>Privacy/AVG: verwerkingsregister en grondslagregistratie op orde, volgens AVG artikel 6 en 30 respectief. Daarbij komt mee alleen noodzakelijke persoonsgegevens opslaan.</li><li>Dataretentie: operationele logs max. 90 dagen, audit-logs conform bewaartermijn in ADR 0005/0007. DPIA uitgevoerd vóór productie.</li><li>Transport & opslag: TLS 1.2+ in transit; gevoelige secrets via sealed secrets, geen gevoelige data in logs. Encryptie-at-rest verplicht indien toepasbaar.</li></ul><h4 id=beschikbaarheid--continuïteit>Beschikbaarheid & Continuïteit</h4><p>Er is nog geen baseline voor bedacht, maar denk hier aan bijvoorbeeld:</p><ul><li>Doel beschikbaarheid betafase: ≥ 50% tijdens kantoortijden. Doel productie: ≥ 99,9% 24x7 (excl. gepland onderhoud). Vastgelegd als Service Level Objective (SLO) en gemonitord.</li><li>Onderhoud: onaangekondigd tijdens betafase.</li></ul><h4 id=performance--schaalbaarheid>Performance & Schaalbaarheid</h4><p>Er is nog geen baseline voor bedacht, maar denk hier aan bijvoorbeeld:</p><ul><li>Lezen (profiel opvragen door dienstverlener of gebruiker): p95 latency ≤ 150 ms binnen hetzelfde datacentrum; p99 ≤ 300 ms.</li><li>Schrijven (profiel wijzigen door gebruiker): p95 end-to-end ≤ 500 ms exclusief out-of-band kanaalverificatie (e-mail/SMS). Kanaalverificatie is async en beïnvloedt UI-flow, niet server-SLA.</li><li>Capaciteit: initieel kleine groep profielen (beta), maar schaalbaar naar 2M+ profielen. Opslag en indices ontwerpen voor lineaire schaal.</li></ul><h4 id=auditability--logging-ldv>Auditability & Logging (LDV)</h4><ul><li>Audit log: conform ADR 0005 en ADR 0007 worden relevante mutaties en bevragingen vastgelegd met wie/wat/wanneer/waarom. Alle muterende acties audit-logged en elke bevragingen geregistreerd voor transparantie/terugzoekbaarheid volgens LDV standaard.</li><li>Onweerlegbaarheid: timestamps (UTC), correlatie-ID, en event-idempotency waar relevant. Toegang tot audit-logs is strikt geautoriseerd.</li></ul><h4 id=interoperabiliteit--open-standaarden>Interoperabiliteit & Open Standaarden</h4><ul><li>API-contracten in OpenAPI 3.0+, JSON over HTTPS. HTTP-standaarden volgen REST best practices.</li><li>Identiteiten en claims volgen de OIDC-standaard; authenticatie verloopt via erkende IdP’s (DigiD, eHerkenning, eIDAS).</li><li>Koppelingen met KvK en andere bronnen via hun officiële API-standaarden. Afstemming met Federatief Data Stelsel (FDS) en LDV-implementatie (ADR 0010).</li></ul><h4 id=observeerbaarheid>Observeerbaarheid</h4><p>Er is nog geen baseline voor bedacht, maar denk hier aan bijvoorbeeld:</p><ul><li>Metrics: minimaal request-latency (p50/p95/p99), error-rate per endpoint, throughput, resource verbruik. Dashboards gepubliceerd en gedeeld met beheer.</li><li>Tracing: Gedistribueerd tracing over inkomende en uitgaande calls. Log-niveau: INFO standaard, WARN/ERROR voor afwijkingen.</li></ul><h4 id=herstelbaarheid-back-uprestore-dr>Herstelbaarheid (Back-up/Restore, DR)</h4><p>Er is nog geen baseline voor bedacht, maar denk hier aan bijvoorbeeld:</p><ul><li>RPO ≤ XYZ minuten</li><li>RTO ≤ 1? dag in pilot, ≤ XYZ minuten in productie.</li><li>Back-ups getest op herstel per half jaar.</li><li>Audit-log reconstructie (reverse delta read) is niet standaard, maar beschikbaar als laatste redmiddel bij noodgevallen (zie ADR 0005).</li></ul><h3 id=buiten-scope--expliciete-uitsluitingen>Buiten scope / expliciete uitsluitingen</h3><ul><li>Meertalige UI is niet vereist in de betafase?. ZIE PUNT 2 TOEGANKELIJKHEID & GEBRUIKSVRIENDELIJKHEID.</li><li>SEO en PWA-eisen zijn momenteel niet van toepassing.</li><li>Offline-first gebruik is uitgesloten.</li></ul><h3 id=meting-en-borging>Meting en borging</h3><ul><li>Geautomatiseerde kwaliteitscontroles (linting, security scanning/CVE), contracttests op API’s, Lighthouse voor front-end, performance tests (load/stress) in CI/CD, Unit tests voor business logica.</li><li>SLO’s/SLA’s worden actief gemonitord en afwijkingen leiden tot incidenten en/of verbeteracties.</li></ul><h2 id=beperkingen>Beperkingen</h2><h3 id=inleiding-2>Inleiding</h3><p>Deze sectie beschrijft de expliciete randvoorwaarden en beperkingen waarbinnen de Profiel Service wordt ontworpen en gerealiseerd.
Doel is om gemaakte keuzes en context te borgen en later te kunnen herleiden waarom bepaalde opties zijn overwogen.</p><h3 id=overzicht-2>Overzicht</h3><p>De volgende categorieën beperkingen zijn van toepassing. Per punt noemen we wat de beperking inhoudt, door wie/waarom deze is opgelegd en de impact op de architectuur.</p><h4 id=organisatorische-en-tijdbudget-beperkingen>Organisatorische en tijd/budget beperkingen</h4><ul><li>Betafase: lever een werkende beta met kernfunctionaliteit binnen beperkte tijd en middelen. Opgelegd door programma. Impact: focus op ‘must haves’; nice-to-haves. Systeem is uitbreidbaar richting productie, maar implementeert in de beta een minimale set.</li></ul><h4 id=identiteit-authenticatie-en-autorisatie>Identiteit, authenticatie en autorisatie</h4><ul><li>Verplicht ondersteuning van federatieve authenticatie (DigiD, eHerkenning, eIDas) en OIDC/OAuth2 (ADR 0006). Opgelegd door rijksbeleid en interoperabiliteitseisen en benodigde gebruikersinformatie. Impact: eigen credential management is uitgesloten; integratie met IDP’s bepaalt login-flows en token-handling. Voor betafase waarschijnlijk alleen eHerkenning.</li><li>Scope-gebaseerde autorisatie voor dienstverleners via FDS; scopes beperken toegang tot de minimaal noodzakelijke rechten (least privilege), bijvoorbeeld read-only waar van toepassing. Opgelegd door architectuurkader; alle API’s moeten scopes/claims afdwingen.</li></ul><h4 id=juridisch-en-compliance>Juridisch en compliance</h4><ul><li>AVG toepasselijke logging/LDV-vereisten (ADR 0007, 0010). Opgelegd door wet- en regelgeving. Impact: auditeerbare gebeurtenissen, transparantie en bewaartermijnen zijn verplicht, persoonlijk identificeerbare informatie in logging vermijden.</li><li>Gebruik van KvK-gegevens conform betreffende API-voorwaarden. Impact: caching/bewaren van externe gegevens is ingezet, met beperkingen, en aan voorwaarden gebonden.</li></ul><h4 id=technologiestack-en-standaarden>Technologiestack en standaarden</h4><ul><li>API’s in OpenAPI 3.0+, JSON over HTTPS; gebruik van standaard HTTP-protocollen. Impact: geen propriëtaire protocol keuzes.</li></ul><h4 id=integraties-en-afhankelijkheden>Integraties en afhankelijkheden</h4><ul><li>Afhankelijkheid van externe stelsels/voorzieningen: IDP’s (DigiD/eHerkenning/eIDas), KvK, LDV/FDS. Opgelegd door functionele doelstellingen. Impact: beschikbaarheid en performance worden mede bepaald door externe SLA’s; timeouts, retries en circuit breakers zijn nodig.
TODO Willen wij hiervoor circuit breakers gebruiken?</li></ul><h4 id=deploy--en-hostingkader>Deploy- en hostingkader</h4><ul><li>Uitrol op een standaard overheidscloud/infrastructuur met centrale voorzieningen (logging, monitoring, secret management). Opgelegd door hostingpartij/beheer. Impact: keuze voor specifieke PaaS-diensten of databases kan beperkt zijn; encryptie-at-rest en netwerkpolicies volgen platform-standaard.</li><li>Netwerkbeperkingen: alleen uitgaand verkeer naar whitelisted endpoints (bijv. KvK, IDP’s). Impact: service discovery en integraties moeten binnen deze restricties werken.</li></ul><h4 id=ontwikkelproces-en-team>Ontwikkelproces en team</h4><ul><li>Uitgebreid team, maar gedeelde capaciteit met andere deelprojecten. Opgelegd door programma. Impact: prioritering op kerndoelen, gefaseerde oplevering. Automatisering (CI/CD, tests) is essentieel om snelheid/kwaliteit te borgen.</li></ul><h4 id=data-en-migratie>Data en migratie</h4><ul><li>Geen migratie van historisch profielmateriaal uit legacy. Opgelegd door scopebeperking. Impact: betafase start ‘greenfield’; koppeling aan bestaande datasets gebeurt via bronverificatie (b.v. KvK). Potentiële datamigratie naar productie wordt onderzocht in overleg met de betrokken dienstverleners, om te bepalen of deze technisch haalbaar is en of het meerwaarde biedt.</li></ul><h3 id=waarom-deze-beperkingen-ertoe-doen>Waarom deze beperkingen ertoe doen</h3><ul><li>Beperken van keuzes versnelt ontwerp en implementatie, maar stuurt ook de architectuur: federatieve auth en FDS-scopes vereisen strikte scheiding van verantwoordelijkheden en dataminimalisatie; LDV/AVG dwingt auditability en logging-architectuur; hosting- en netwerkstandaarden bepalen integratiepatronen (API-gateway, TLS, secrets). Door deze constraints expliciet te maken, voorkomen we schijnbaar ‘vreemde’ keuzes achteraf.</li></ul><h3 id=verwijzingen>Verwijzingen</h3><ul><li>ADR 0005 – AuditLog & EventSourcing</li><li>ADR 0006 – Federatieve authenticatie en autorisatie op basis van OIDC en eIDas</li><li>ADR 0007 – Logboek dataverwerking (LDV)</li><li>ADR 0009 – NL Design System</li><li>ADR 0010 – LDV implementatie</li></ul><h2 id=design-principes>Design Principes</h2><h3 id=inleiding-3>Inleiding</h3><p>Het doel van dit hoofdstuk is om expliciet te maken welke principes we volgen, zodat ontwerp- en implementatiekeuzes consistent en uitlegbaar zijn voor alle betrokkenen.
Indien een principe is vastgelegd in een ADR of elders, is een verwijzing opgenomen. In andere gevallen is een korte toelichting toegevoegd.</p><h3 id=principes>Principes</h3><p>De onderstaande principes ondersteunen de kwaliteitseisen in het kwaliteitseisen hoofdstuk
en vormen samen met de ADR’s de basis voor ontwerpkeuzes in de software-architectuur.</p><ul><li><p>Open standaarden, tenzij<br>We geven de voorkeur aan open, breed gedragen standaarden voor interoperabiliteit.<br>Voorbeelden: OpenAPI 3 voor API’s, JSON/HTTP, OIDC/OAuth 2.0 voor federatieve login.</p></li><li><p>Contract-first API-ontwikkeling (OpenAPI)<br>API’s worden beschreven in OpenAPI en versiebeheer (semantic versioning) wordt toegepast op contracten. Documentatie en try-out via Swagger.</p></li><li><p>Beveiliging en privacy by design<br>Minimaalheidsprincipe (data-minimalisatie), least-privilege, encryptie in transit, auditing van mutaties en bevragingen.<br>Verwijzingen: ADR 0005 (AuditLog/EventSourcing), ADR 0006 (federatieve authenticatie/authorisatie), ADR 0007 (Logboek Dataverwerking), ADR 0008 (Data-eigenaar).</p></li><li><p>Federatieve authenticatie en autorisatie<br>Inloggen via erkende identiteiten (DigiD, eHerkenning, eIDas). Token-gebaseerde toegang via OIDC/OAuth 2.0.<br>Verwijzing: ADR 0006.</p></li><li><p>Hoge cohesie, lage koppeling<br>Services en modules hebben een duidelijke, beperkte verantwoordelijkheid en communiceren via expliciete contracten. Dit vergroot onderhoudbaarheid en vervangbaarheid.</p></li><li><p>SOLID en DRY<br>Klassen en componenten volgen Single Responsibility; we vermijden duplicatie en prefereren hergebruik van gedeelde bouwblokken.</p></li><li><p>Dependency Injection<br>Losse koppeling via interfaces en dependency inversion; concrete implementaties worden via CDI geïnjecteerd.<br>Het gekozen DI-mechanisme volgt de Quarkus-standaard (Jakarta CDI/Arc).</p></li><li><p>Architecturale gelaagdheid en scheiding van verantwoordelijkheden<br>Duidelijke scheiding tussen API-/controllerlaag, applicatie-/servicelaag en persistentierepository.<br>Businesslogica bevindt zich uitsluitend in de servicelaag; controllers bevatten geen businesslogica en hebben geen directe database-toegang.</p></li><li><p>Stateless services<br>Schaalbaarheid en eenvoudige uitrol door stateless service-instances; state wordt in expliciete data stores of messaging vastgelegd.<br>Verwijzing: Kwaliteitseisen – Beschikbaarheid & Schaalbaarheid (profielservicedocs/03-kwaliteitseisen.md).</p></li><li><p>Auditability als first-class concern<br>Alle muterende acties en reads)worden vastgelegd ten behoeve van transparantie.<br>Verwijzingen: ADR 0005, ADR 0007, ADR 0010. Zie ook Beperkingen - Juridisch en compliance (profielservicedocs/04-beperkingen.md).</p></li><li><p>Het wiel niet opnieuw uitvinden<br>Voorkeur voor hergebruik van standaarden, componenten en SDK’s boven maatwerk, tenzij harde eisen dit verhinderen.<br>Verwijzingen: ADR’s en koppelingen met OpenZaak/OpenKlant (ADR 0004), NL Design System (ADR 0009).</p></li><li><p>Gemeenschappelijke aanpak voor foutafhandeling, logging en tracing<br>Eenduidige error-responses op API’s, centrale correlatie-ID, gestructureerde logging en distributed tracing.<br>Verwijzing: Kwaliteitseisen – Observeerbaarheid (profielservicedocs/03-kwaliteitseisen.md), ADR 0010.</p></li><li><p>Domeinmodel: rijk waar nodig, anemisch waar passend<br>De Profielservice hanteert een pragmatische domeinstrategie op basis van boundedcontexts.<br>Domeingebieden met niet-triviale bedrijfs- of wettelijke regels (zoals profielbeheer, autorisatie van dienstverleners en privacy/toestemming) gebruiken een rijk domeinmodel waarin invarianten expliciet worden afgedwongen.<br>Domeingebieden die primair technisch of CRUD-gedreven zijn (zoals identiteitskoppelingen en auditlogging) hanteren een anemisch domeinmodel om complexiteit te beperken.</p></li><li><p>Consistente naamgeving en API-conventies<br>RESTful paden, HTTP-methoden semantisch correct, duidelijke statuscodes en foutstructuren.<br>TODO: API style guide toevoegen? Of vinden we dat te veel van het goede?</p></li><li><p>Koppelen via officiële API’s en registers<br>Integraties met o.a. KvK en andere bronnen verlopen via hun officiële API-standaarden.<br>Verwijzing: Kwaliteitseisen – Interoperabiliteit & Open Standaarden.</p></li></ul><h2 id=software-architectuur>Software architectuur</h2><h3 id=systeem-landschap-diagram>Systeem Landschap diagram</h3><p>De Systeem landschap diagram geeft een overzicht van alle actoren binnen het geprojecteerde landschap.<br>Dus niet alleen de Profiel Service, maar ook de systemen waarmee deze direct of indirect verbonden mee is.<br>Het laat hoogover zien wat benodigd is voor om op verschillende manieren (scenario 2,8 en 9) notificaties te verzenden.</p><iframe id=structurizr-diagram-SysteemLandschap src="/moza-site/preview/pr-34/diagrammen/index.html?iframe=structurizr-diagram-SysteemLandschap#SysteemLandschap" width=100% height=800px></iframe><h3 id=systeem-container-diagram>Systeem Container diagram</h3><iframe id=structurizr-diagram-ProfielServiceContainer src="/moza-site/preview/pr-34/diagrammen/index.html?iframe=structurizr-diagram-ProfielServiceContainer#ProfielServiceContainer" width=100% height=800px></iframe><p>Dit diagram toont het containerniveau van de Profiel Service en de systemen waarmee deze interageert. De Profiel Service bestaat uit een service-laag met een achterliggende database. Daarnaast raadpleegt de service het Handelsregister, om twee redenen:</p><ol><li>Het tonen van bedrijfsinformatie aan zakelijke gebruikers via MijnOverheid Zakelijk.</li><li>Het verstrekken van adresgegevens aan de Berichtenbox voor Burgers en Ondernemers (BBO), wanneer deze daar om vraagt.</li></ol><h2 id=code>Code</h2><h3 id=profiel-beheren>Profiel Beheren</h3><p>Hierin staan de patronen beschreven over hoe een zakelijke gebruiker zijn profiel zou beheren.</p><h4 id=profiel-bekijken>Profiel bekijken</h4><p><img src=./images/ArchitectuurProfielService/SeqContactgegevensBekijken.png alt="Profiel bekijken" title="Profiel bekijken"></p><details><summary>Zie mermaid code</summary><pre><code>sequenceDiagram
    actor ZakelijkGebruiker
    ZakelijkGebruiker-&gt;&gt;MijnOverheid Zakelijk: Navigeert naar Contactgegevens
    activate MijnOverheid Zakelijk
    MijnOverheid Zakelijk-&gt;&gt;Profiel service:Haalt contactgegevens op
    deactivate MijnOverheid Zakelijk
    activate Profiel service
    Profiel service-&gt;&gt;Logboek Dataverwerking: READ log wegschrijven
    deactivate Profiel service
    activate Logboek Dataverwerking
    Logboek Dataverwerking--&gt;&gt;Profiel service: Ok
    deactivate Logboek Dataverwerking
    activate Profiel service
    Profiel service--&gt;&gt;MijnOverheid Zakelijk: Geeft contactgegevens terug
    deactivate Profiel service
    activate MijnOverheid Zakelijk
    MijnOverheid Zakelijk--&gt;&gt;ZakelijkGebruiker: Ziet zakelijke contactgegevens
    deactivate MijnOverheid Zakelijk
</code></pre></details><h4 id=email-updaten--verifiëren>Email updaten & verifiëren</h4><p><img src=./images/ArchitectuurProfielService/SeqUpdateEmail.png alt="Update Email" title="Update Email"></p><details><summary>Zie mermaid code</summary><pre><code>sequenceDiagram
    actor ZakelijkGebruiker
    ZakelijkGebruiker-&gt;&gt;MijnOverheid Zakelijk: Update email Request
    activate MijnOverheid Zakelijk
    MijnOverheid Zakelijk-&gt;&gt;Profiel service: Verstuurt email update
    deactivate MijnOverheid Zakelijk
    activate Profiel service
    participant AuditLog@{ &quot;type&quot; : &quot;database&quot; }
    participant EmailVerificatieService
    Profiel service-&gt;&gt;AuditLog: 'Update aangevraagd'-log opslaan
    deactivate Profiel service
    activate AuditLog
    AuditLog--&gt;&gt;Profiel service: Ok
    deactivate AuditLog
    activate Profiel service
    Profiel service-&gt;&gt;EmailVerificatieService: Start verificatieprocess
    deactivate Profiel service
    activate EmailVerificatieService
    EmailVerificatieService--&gt;&gt;ZakelijkGebruiker: Verstuur mail met verificatiecode
    deactivate EmailVerificatieService
    activate ZakelijkGebruiker
    ZakelijkGebruiker-)MijnOverheid Zakelijk: Verifieer email verificatiecode
    deactivate ZakelijkGebruiker
    activate MijnOverheid Zakelijk
    MijnOverheid Zakelijk-&gt;&gt;Profiel service: Verstuurt verificatie verzoek
    deactivate MijnOverheid Zakelijk
    activate Profiel service
    Profiel service-&gt;&gt;EmailVerificatieService:  Verifieer verificatie verzoek
    deactivate Profiel service
    activate EmailVerificatieService
    EmailVerificatieService--&gt;&gt;Profiel service: Bevestig verificatie
    deactivate EmailVerificatieService
    activate Profiel service
    Profiel service-&gt;&gt;AuditLog: 'Update geverifieerd'-log opslaan
    deactivate Profiel service
    activate AuditLog
    AuditLog--&gt;&gt;Profiel service: Ok
    deactivate AuditLog
    activate Profiel service
    Profiel service--&gt;&gt;MijnOverheid Zakelijk: Profiel gegevens
    deactivate Profiel service
    activate MijnOverheid Zakelijk
    MijnOverheid Zakelijk--&gt;&gt;ZakelijkGebruiker: Succes pagina
    deactivate MijnOverheid Zakelijk
</code></pre></details><h3 id=authenticatie>Authenticatie</h3><p>Hierin staan de patronen beschreven over hoe het inlog process van een zakelijke gebruiker of organisatie zou verlopen.
Aan het einde van dit hoofdstuk worden de te verwachten attributen per inlogmethode beschreven, met daarbij aangegeven welke verplicht of optioneel zijn.
Eerst is een flow chart te zien die aangeeft wat de ondernemer kan verwachten aan de hand van de inlogmethode die hij/zij gebruikt.</p><p><img src=./images/ArchitectuurProfielService/AuthenticatieFlowChart.png alt="Auth Flowchart" title="Auth Flowchart"></p><details><summary>Zie mermaid code</summary><pre><code>    flowchart TD;
    %% Trigger
        TRIGGER([De ondernemer wilt zijn contactgegevens updaten])--&gt;S1;

    %% DigId scenario
        S1[Het systeem laat de inlog opties zien: 1. Digid, 2. eHerkenning, 3. eIDas als Burger 4. eIDas als Organisatie]--&gt;S2;
        S2[De ondernemer kiest Digid]--&gt;S3;
        S3[Het systeem met behulp van het BSN haalt hij de relevant KVK's op bij de KVK-BSN api.];
        S3--&gt;SUCCESS_DigId;

    %% eHerkenning scenario
        S1--&gt;EXT2a1;
        EXT2a1[De ondernemer kiest eHerkenning]--&gt;EXT2a2;
        EXT2a2[Het systeem haalt de KVK &amp; BSN uit de eHerkenning. Voor BSN komt die uit NIN &amp; NIN_TYPE.]--&gt;EXT2a3;
        EXT2a3[OPTIE: Het systeem gebruikt het BSN om de andere KVK's op te halen bij de KVK-BSN api??.];
        EXT2a2--&gt;SUCCESS_eHerkenning;
        EXT2a3--&gt;SUCCESS_eHerkenning;

    %% eIDas scenario
        S1--&gt;EXT3a1;
        EXT3a1[De ondernemer kiest eIDas Burger]--&gt;EXT3a2;
        EXT3a2[Het systeem haalt de Person Identifier, en optioneel Representative Person Identifier uit eIDas.];
        EXT3a2--&gt;SUCCESS_eIDas_Burger;

        S1--&gt;EXT4a1;
        EXT4a1[De ondernemer kiest eIDas Organisatie]--&gt;EXT4a2;
        EXT4a2[Het systeem haalt de Legal Person Identifier, en optioneel Legal Entity Identifier uit eIDas.];
        EXT4a2--&gt;SUCCESS_eIDas_Organisatie;

        SUCCESS_DigId([De ondernemer kan zijn contactgegevens updaten voor zichzelf en al zijn ondernemingen]);
        SUCCESS_eHerkenning([De ondernemer kan zijn contactgegevens updaten voor zichzelf en 1 onderneming]);
        SUCCESS_eIDas_Burger([De ondernemer kan zijn contactgegevens updaten voor deze eIDas Person Identifier]);
        SUCCESS_eIDas_Organisatie([De ondernemer kan zijn contactgegevens updaten voor deze eIDas Legal Person Identifier]);
</code></pre></details><h3 id=digid>DigiD</h3><table><thead><tr><th>Attribuut</th><th>Aanwezigheid</th><th>Opmerkingen</th></tr></thead><tbody><tr><td>BSN</td><td><strong>Verplicht</strong></td><td>Burgerservicenummer</td></tr><tr><td>Voornaam</td><td><strong>Verplicht</strong></td><td>Van BRP</td></tr><tr><td>Achternaam</td><td><strong>Verplicht</strong></td><td>Van BRP</td></tr><tr><td>Geboortedatum</td><td><strong>Verplicht</strong></td><td>Van BRP</td></tr><tr><td>Geslacht</td><td>Optioneel</td><td>Van BRP</td></tr><tr><td>Nationaliteit</td><td>Optioneel</td><td>Van BRP</td></tr><tr><td>Adres</td><td>Optioneel</td><td>Van BRP</td></tr><tr><td>Zekerheidniveau</td><td><strong>Verplicht</strong></td><td>Basic / Substantial / High</td></tr></tbody></table><h3 id=eherkenning>eHerkenning</h3><table><thead><tr><th>Attribuut</th><th>Aanwezigheid</th><th>Opmerkingen</th></tr></thead><tbody><tr><td>KvKNummer</td><td><strong>Verplicht</strong></td><td>Kamer van koophandel nummer</td></tr><tr><td>WettelijkeNaam</td><td><strong>Verplicht</strong></td><td>Geregistreerde naam</td></tr><tr><td>Rechtsvorm</td><td>Optioneel</td><td>BV, NV, Stichting, etc.</td></tr><tr><td>BSN</td><td><strong>Bij uitzondering</strong></td><td>Indien doelbinding</td></tr><tr><td>RSIN</td><td><strong>Bij uitzondering</strong></td><td>Indien niet zzp</td></tr><tr><td>PsuedoID</td><td><strong>Bij uitzondering</strong></td><td>Indien niet gerechtigd op bsn</td></tr><tr><td>Psuedo</td><td><strong>Bij uitzondering</strong></td><td>Indien niet gerechtigd op bsn</td></tr><tr><td>Vestigingsnummer</td><td><strong>Bij uitzondering</strong></td><td>Indien gemachtigd op een specifieke vestiging</td></tr><tr><td>PROBAS</td><td>Optioneel??</td><td>BD nummer voor organisaties buiten het Handelsregister</td></tr><tr><td>TTR-BD</td><td>Optioneel??</td><td>BD en Douane uitgereikt nummer aan restgroepen die niet in handelsregister staan</td></tr><tr><td>eIDas</td><td>Optioneel??</td><td>eIDas loopt via eHerkenning, nog uitzoeken hoe dit precies werkt in praktijk.</td></tr></tbody></table><h3 id=eidas>eIDas</h3><h4 id=persoon>Persoon</h4><table><thead><tr><th>Attribuut</th><th>Aanwezigheid</th><th>Notitie</th></tr></thead><tbody><tr><td>PersonIdentifier</td><td><strong>Verplicht</strong></td><td>Unique identifier for a natural person</td></tr><tr><td>GivenName</td><td><strong>Verplicht</strong></td><td>First name</td></tr><tr><td>FamilyName</td><td><strong>Verplicht</strong></td><td>Last name</td></tr><tr><td>DateOfBirth</td><td><strong>Verplicht</strong></td><td>ISO 8601</td></tr><tr><td>PlaceOfBirth</td><td>Optioneel</td><td>As defined by schema</td></tr><tr><td>Gender</td><td>Optioneel</td><td>Schema-defined</td></tr><tr><td>Nationality</td><td>Optioneel</td><td>ISO 3166-1</td></tr><tr><td>LPID</td><td><strong>Moet afwezig zijn</strong></td><td>Legal-person identifier not allowed</td></tr><tr><td>LEI</td><td><strong>Moet afwezig zijn</strong></td><td>Business-only identifier</td></tr></tbody></table><h4 id=organisatie>Organisatie</h4><table><thead><tr><th>Attribuut</th><th>Aanwezigheid</th><th>Notitie</th></tr></thead><tbody><tr><td>LPID</td><td><strong>Verplicht</strong></td><td>Legal Person Identifier</td></tr><tr><td>LegalName</td><td><strong>Verplicht</strong></td><td>Registered legal name</td></tr><tr><td>LegalForm</td><td>Optioneel</td><td>e.g. BV, GmbH, SARL</td></tr><tr><td>RegisteredAddress</td><td><strong>Verplicht</strong></td><td>Official registered address</td></tr><tr><td>CountryOfRegistration</td><td><strong>Verplicht</strong></td><td>ISO 3166-1 alpha-2</td></tr><tr><td>BusinessRegisterID</td><td><strong>Verplicht</strong></td><td>National business registry number</td></tr><tr><td>LEI</td><td>Optioneel</td><td>Financial-sector use cases</td></tr><tr><td>PersonIdentifier</td><td><strong>Moet afwezig zijn</strong></td><td>Natural-person identifier not allowed</td></tr><tr><td>GivenName</td><td><strong>Moet afwezig zijn</strong></td><td>Natural-person attribute</td></tr><tr><td>FamilyName</td><td><strong>Moet afwezig zijn</strong></td><td>Natural-person attribute</td></tr><tr><td>DateOfBirth</td><td><strong>Moet afwezig zijn</strong></td><td>Natural-person attribute</td></tr></tbody></table><h4 id=regels>Regels</h4><table><thead><tr><th>Regel</th><th>Beschrijving</th></tr></thead><tbody><tr><td>Subject Type</td><td>Credentials vertegenwoordigt <strong>ofwel</strong> Natuurlijk Persoon <strong>of</strong> Rechtspersoon</td></tr><tr><td>Identifier Exclusivity</td><td>PersonIdentifier en LPID zijn <strong>wederzijds uitsluitend</strong></td></tr><tr><td>Attribute Exclusivity</td><td>Natuurlijk persoon en rechtspersoon attributen <strong>mogen niet gemengd worden</strong></td></tr><tr><td>Representation</td><td>Een persoon die namens een bedrijf handelt wordt via aparte credentials teruggegeven</td></tr><tr><td>LEI Usage</td><td>Optioneel en nooit de enige vereiste identifier</td></tr><tr><td>Validation</td><td>Weiger credentials met gemengde subject attributen</td></tr></tbody></table><h2 id=data>Data</h2><h3 id=gegevensmodel>Gegevensmodel</h3><p>Het gegevensmodel van de ProfielService is opgebouwd rond de entiteiten <strong>PARTIJ</strong> en <strong>CONTACTGEGEVEN</strong>.</p><ol><li><strong>PARTIJ</strong> is de basis van een natuurlijke persoon of rechtspersoon. Een partij kan één of meerdere identificaties hebben, zoals BSN, KVK, RSIN of andere vormen van identificatie.</li><li><strong>CONTACTGEGEVEN</strong> legt vast hoe en via welk kanaal een partij gecontacteerd kan worden door een dienst of organisatie.</li></ol><p>Hiermee kunnen burgers en ondernemers vastleggen hoe zij gecontacteerd willen worden, bijvoorbeeld via e-mail of telefoon.</p><p>Ter ondersteuning van deze kernfunctionaliteit zijn vier aanvullende entiteiten toegevoegd: <strong>IDENTIFICATIE</strong>, <strong>VOORKEUR</strong>, <strong>DIENSTVERLENER</strong> en <strong>DIENSTVERLENER_AFDELING</strong>.</p><p>Hieronder volgt een tabel met de definities die wij hanteren voor deze entiteiten.</p><h4 id=partij>PARTIJ</h4><table><thead><tr><th>Attribuut</th><th>Omschrijving</th></tr></thead><tbody><tr><td><strong>PARTIJ</strong></td><td></td></tr><tr><td>Id</td><td>Unieke identificator van PARTIJ</td></tr></tbody></table><h4 id=contactgegeven>CONTACTGEGEVEN</h4><table><thead><tr><th>Attribuut</th><th>Omschrijving</th></tr></thead><tbody><tr><td><strong>CONTACTGEGEVEN</strong></td><td></td></tr><tr><td>Id</td><td>Unieke identificator van contactgegeven</td></tr><tr><td>PartijId</td><td>Identificator van de PARTIJ die eigenaar is van dit contactgegeven</td></tr><tr><td>ScopeId</td><td>Verwijzing naar DIENST waarop de scope betrekking heeft</td></tr><tr><td>Taal</td><td>De taalvoorkeur voor dit contactgegeven</td></tr><tr><td>ContactType</td><td>Het soort contactgegeven: e-mail of (mobiel) telefoonnummer</td></tr><tr><td>Waarde</td><td>De opgegeven contactwaarde (bijv. mailadres)</td></tr><tr><td>TerAttentieVan</td><td>Aanhef die gebruikt kan worden bij het gebruik van dit contactgegeven</td></tr><tr><td>GeverifieerdAt</td><td>Datum waarop de verificatiestatus voor het laatst is gezet</td></tr></tbody></table><h4 id=identificatie>IDENTIFICATIE</h4><table><thead><tr><th>Attribuut</th><th>Omschrijving</th></tr></thead><tbody><tr><td><strong>DIENSTVERLENER</strong></td><td></td></tr><tr><td>PartijId</td><td>Identificator van de PARTIJ die eigenaar is van dit CONTACTGEGEVEN</td></tr><tr><td>IdentificatieType</td><td>Wijze waarop PARTIJ uniek kan worden geïdentificeerd: BSN, KVK, RSIN of ander identificatiesysteem</td></tr><tr><td>IdentificatieNummer</td><td>Nummer waarmee PARTIJ uniek identificeerbaar is binnen het opgegeven IdentificatieType</td></tr></tbody></table><h4 id=voorkeur>VOORKEUR</h4><table><thead><tr><th>Attribuut</th><th>Omschrijving</th></tr></thead><tbody><tr><td><strong>VOORKEUR</strong></td><td></td></tr><tr><td>PartijId</td><td>Verwijzing naar de PARTIJ waarvoor de voorkeur geldt</td></tr><tr><td>VoorkeurType</td><td>Het type voorkeur (enum), bijvoorbeeld taal of communicatievorm</td></tr><tr><td>ScopeId</td><td>Verwijzing naar DIENST waarop de scope betrekking heeft</td></tr><tr><td>Waarde</td><td>De waarde van de voorkeur, afhankelijk van het VoorkeurType</td></tr></tbody></table><h4 id=dienstverlener>DIENSTVERLENER</h4><table><thead><tr><th>Attribuut</th><th>Omschrijving</th></tr></thead><tbody><tr><td><strong>DIENSTVERLENER</strong></td><td></td></tr><tr><td>Id</td><td>Unieke identificator van DIENSTVERLENER</td></tr><tr><td>Naam</td><td>Naam van de dienstverlener</td></tr></tbody></table><h4 id=dienst>DIENST</h4><table><thead><tr><th>Attribuut</th><th>Omschrijving</th></tr></thead><tbody><tr><td><strong>DIENST</strong></td><td></td></tr><tr><td>Id</td><td>Unieke identificator van de dienst</td></tr><tr><td>DienstverlenerId</td><td>Verwijzing naar DIENSTVERLENER</td></tr><tr><td>Beschrijving</td><td>Beschrijving van de dienst</td></tr></tbody></table><p>Het onderstaande diagram geeft de structuur van het gegevensmodel weer, inclusief de relaties tussen PARTIJ, VOORKEUR, CONTACTGEGEVEN, DIENSTVERLENER, en DIENST.</p><p><img src=./images/ArchitectuurProfielService/Gegevensmodel.png alt=Gegevensmodel title=Gegevensmodel></p><details><summary>Zie mermaid code</summary><pre><code>erDiagram
    PARTIJ {
        int Id PK &quot;NOT NULL&quot;
    }

    CONTACTGEGEVEN {
        int Id PK &quot;NOT NULL&quot;
        int PartijId FK &quot;NOT NULL&quot;
        id Scope FK &quot;&quot;
        enum Taal
        enum ContactType &quot;NOT NULL&quot;
        text Waarde &quot;NOT NULL&quot;
        bool IsGeverifieerd &quot;NOT NULL&quot;
        date GeverifieerdAt &quot;NOT NULL&quot;
    }

    VOORKEUR {
        int PartijId PK,FK &quot;NOT NULL&quot;
        enum VoorkeurType PK &quot;NOT NULL&quot;
        text Waarde &quot;NOT NULL&quot;
    }

    IDENTIFICATIE {
        int PartijId PK,FK &quot;NOT NULL&quot;
        enum IdentificatieType PK &quot;NOT NULL&quot;
        text IdentificatieNummer PK &quot;NOT NULL&quot;
    }

    DIENSTVERLENER {
        int Id PK &quot;NOT NULL&quot;
        string Naam &quot;NOT NULL&quot;
    }

    DIENSTVERLENER_AFDELING {
        int Id PK &quot;NOT NULL&quot;
        int DienstverlenerId FK &quot;NOT NULL&quot;
        string Beschrijving &quot;&quot;
    }

    %% Relationships
    PARTIJ ||--|{ IDENTIFICATIE : &quot;PartijId&quot;
    PARTIJ ||--o{ VOORKEUR : &quot;PartijId&quot;
    PARTIJ ||--o{ CONTACTGEGEVEN : &quot;PartijId&quot;
    DIENSTVERLENER_AFDELING ||--o{ CONTACTGEGEVEN : &quot;ScopeId&quot;
    DIENSTVERLENER ||--|{ DIENSTVERLENER_AFDELING : &quot;DienstverlenerId&quot;
</code></pre></details><h4 id=data-transfer-object-dto>Data Transfer Object (DTO)</h4><p>Wanneer de profiel-service wordt bevraagd, kan onderstaand DTO als response worden verwacht:</p><p><strong>YAML</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>id</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>identifier_type</span>: <span style=color:#ae81ff>BSN</span>
</span></span><span style=display:flex><span><span style=color:#f92672>identifier_id</span>: <span style=color:#e6db74>&#34;123456789&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>contactvoorkeuren</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>101</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>EMAIL</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>waarde</span>: <span style=color:#ae81ff>rvo-afdeling@bedrijf.nl</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>scope</span>: <span style=color:#ae81ff>ZAKELIJK</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>voor_partij_id</span>: <span style=color:#ae81ff>1001</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>dienst_type</span>: <span style=color:#e6db74>&#34;0000000123&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>geverifieerd_at</span>: <span style=color:#e6db74>&#34;2025-11-03T12:00:00Z&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>102</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>POST</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>waarde</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>ter_attentie_van</span>: <span style=color:#e6db74>&#34;Robbert&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>straat</span>: <span style=color:#ae81ff>Wilhelminastraat</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>huisnummer</span>: <span style=color:#ae81ff>52</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>postcode</span>: <span style=color:#e6db74>&#34;2215PA&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>plaats</span>: <span style=color:#ae81ff>Den Haag</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>land</span>: <span style=color:#ae81ff>Nederland</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>scope</span>: <span style=color:#ae81ff>ZAKELIJK</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>voor_partij_id</span>: <span style=color:#ae81ff>1001</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>dienst_type</span>: <span style=color:#e6db74>&#34;0000000456&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>geverifieerd_at</span>: <span style=color:#e6db74>&#34;2025-11-03T12:00:00Z&#34;</span>
</span></span></code></pre></div><p><strong>JSON</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;identifier_type&#34;</span>: <span style=color:#e6db74>&#34;BSN&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;identifier_id&#34;</span>: <span style=color:#e6db74>&#34;123456789&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;contactvoorkeuren&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>101</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;EMAIL&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;waarde&#34;</span>: <span style=color:#e6db74>&#34;rvo-afdeling@bedrijf.nl&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;scope&#34;</span>: <span style=color:#e6db74>&#34;ZAKELIJK&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;voor_partij_id&#34;</span>: <span style=color:#ae81ff>1001</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;dienst_type&#34;</span>: <span style=color:#e6db74>&#34;0000000123&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;geverifieerd_at&#34;</span>: <span style=color:#e6db74>&#34;2025-11-03T12:00:00Z&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>102</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;POST&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;waarde&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;ter_attentie_van&#34;</span>: <span style=color:#e6db74>&#34;Robbert&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;straat&#34;</span>: <span style=color:#e6db74>&#34;Wilhelminastraat&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;huisnummer&#34;</span>: <span style=color:#ae81ff>52</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;postcode&#34;</span>: <span style=color:#e6db74>&#34;2215PA&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;plaats&#34;</span>: <span style=color:#e6db74>&#34;Den Haag&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;land&#34;</span>: <span style=color:#e6db74>&#34;Nederland&#34;</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;scope&#34;</span>: <span style=color:#e6db74>&#34;ZAKELIJK&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;voor_partij_id&#34;</span>: <span style=color:#ae81ff>1001</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;dienst_type&#34;</span>: <span style=color:#e6db74>&#34;0000000456&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;geverifieerd_at&#34;</span>: <span style=color:#e6db74>&#34;2025-11-03T12:00:00Z&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=sequentiediagrammen>Sequentiediagrammen</h3><p>De volgende diagrammen illustreren de belangrijkste interacties met de ProfielService.</p><ol><li>Dienstverlener bevraagt de ProfielService<br>In dit scenario vraagt een dienstverlener de contactvoorkeuren op van een ondernemer of onderneming.<br>Deze informatie kan de dienstverlener dan gebruiken om kennisgevingen en/of attenderingen correct af te kunnen leveren.</li></ol><p><img src=images/ArchitectuurProfielService/SeqDVBevraagdPS.png alt="Sequentiediagram dienstverlener bevraagd profielservice" title="Sequentiediagram dienstverlener bevraagd profielservice"></p><details><summary>Zie mermaid code</summary><pre><code>sequenceDiagram
    participant Dienstverlener
    participant Profiel as Profiel Service

    Dienstverlener-&gt;&gt;Profiel: GET contactvoorkeuren Bsn en/of KvK
    activate Profiel
    Profiel--&gt;&gt;Dienstverlener: Contactvoorkeur(en) + Bsn
    deactivate Profiel
</code></pre></details><ol start=2><li>Ondernemer bekijkt en wijzigt contactvoorkeuren<br>Dit scenario toont hoe een ondernemer via het MOZa-portaal zijn eigen contactvoorkeuren kan inzien en aanpassen.<br>Afhankelijk van de loginmethode (bijv. DigiD of eHerkenning) worden de relevante ondernemingen opgehaald, waarna de ondernemer zijn voorkeuren per onderneming kan beheren.<br>Na het aanpassen van een voorkeur wordt deze wijziging via de ProfielService opgeslagen, en indien van toepassing geverifieerd.</li></ol><p><img src=./images/ArchitectuurProfielService/SeqOndernemerProfiel.png alt="Sequentiediagram ondernemer bekijkt en update contactvoorkeuren" title="Sequentiediagram ondernemer bekijkt en update contactvoorkeuren"></p><details><summary>Zie mermaid code</summary><pre><code>sequenceDiagram
    actor Ondernemer
    participant MOZa as MOZa Portaal
    participant KvK as KvK
    participant Profiel as Profiel Service

    Ondernemer-&gt;&gt;MOZa: Logt in
    activate MOZa

    alt Als login via DigiD
        MOZa-&gt;&gt;KvK: Haal ondernemingen op voor BSN
        deactivate MOZa
        activate KvK
        KvK--&gt;&gt;MOZa: Geeft ondernemingen terug (KvK-nummers)
        deactivate KvK
        activate MOZa
    end

    MOZa-&gt;&gt;Ondernemer: Toon Profiel Pagina
    Ondernemer-&gt;&gt;MOZa: Opent pagina 'Contactvoorkeuren'

    MOZa-&gt;&gt;Profiel: GET contactvoorkeuren (BSN + KvK)
    deactivate MOZa
    activate Profiel
    Profiel--&gt;&gt;MOZa: Contactvoorkeuren terug
    deactivate Profiel
    activate MOZa

    MOZa-&gt;&gt;Ondernemer: Toon pagina 'Contactvoorkeuren'

    Ondernemer-&gt;&gt;MOZa: Past contactvoorkeur aan

    MOZa-&gt;&gt;Profiel: PATCH contactvoorkeur (BSN + KvK)
    deactivate MOZa
    activate Profiel
    Profiel--&gt;&gt;MOZa: Ok (voorkeur bijgewerkt)
    deactivate Profiel
    activate MOZa

    MOZa--&gt;&gt;Ondernemer: Toont bevestiging
    deactivate MOZa
</code></pre></details><p>Deze scenario’s vormen de basis voor de interacties tussen de ProfielService, dienstverleners en eindgebruikers binnen de keten.</p><h2 id=deployment>Deployment</h2><h3 id=view>View</h3><p>De deployment view van de Profiel Servie is hieronder te vinden, deze bevat uiteindelijk maar 2 containers.
De eerste is de Profiel Service zelf, met daarin de API-componenten en business logica, en de tweede is de bijbehorende postgresql database.</p><iframe id=structurizr-diagram-ProfielServiceDeployment src="/moza-site/preview/pr-34/diagrammen/index.html?iframe=structurizr-diagram-ProfielServiceDeployment#ProfielServiceDeployment" width=100% height=800px></iframe><h3 id=omgeving>Omgeving</h3><p>De omgeving is gehost op het Standaard Platform, specifiek in het TEST cluster van Openshift in de logius-moz-poc namespaces.</p><h4 id=broncode>Broncode</h4><p>De broncode van de applicatie is open-source beschikbaar op <a href=https://www.github.com/MinBZK/moza-profiel-service target=_blank rel="external noopener noreferrer">GitHub</a>.<br>De infrastructuur files staat op de private gitlab server van het Standaard Platform.</p><h2 id=beheer-en-support>Beheer en Support</h2><p>De kans is momenteel aannemelijk dat de hosting hiervan uiteindelijk bij Logius terecht komt,
daardoor hebben wij besloten de Profiel Service in Java/Quarkus op te zetten wat aansluit bij hun tech stack.</p><h3 id=hosting-standaard-platform>Hosting Standaard Platform</h3><p>De omgeving wordt gehost door het Standaard Platform van Logius. Incidenten en wijzigingen kunnen, met de juiste rechten, worden ingeschoten via Topdesk: <a href=https://topdesk.sp-cloudservices.nl/tas/public/login/form target=_blank rel="external noopener noreferrer">https://topdesk.sp-cloudservices.nl/tas/public/login/form</a>.</p><h3 id=benodigde-accounts>Benodigde accounts</h3><ul><li>Logius VPN</li><li>Logius GitLab</li><li>GitHub: <a href=https://github.com/ target=_blank rel="external noopener noreferrer">https://github.com/</a></li></ul></div></article><aside class=toc><h2>Op deze pagina</h2><nav id=TableOfContents><ul><li><a href=#visie>Visie</a></li><li><a href=#wat-is-de-profiel-service>Wat is de Profiel Service</a></li><li><a href=#waarom-een-profiel-service>Waarom een Profiel Service</a></li><li><a href=#doel-en-waarde>Doel en waarde</a><ul><li><a href=#functionele-doelstellingen>Functionele doelstellingen</a></li><li><a href=#strategische-doelstellingen>Strategische doelstellingen</a></li></ul></li><li><a href=#benodigde-afspraken>Benodigde afspraken</a></li><li><a href=#gefaseerde-ontwikkelstrategie>Gefaseerde ontwikkelstrategie</a></li><li><a href=#architectuur-en-uitgangspunten>Architectuur en uitgangspunten</a></li><li><a href=#lange-termijn-visie>Lange termijn visie</a></li><li><a href=#positionering-voor-stakeholders>Positionering voor stakeholders</a></li><li><a href=#oproep-tot-samenwerking>Oproep tot samenwerking</a></li><li><a href=#documentatie--bronnen>Documentatie & Bronnen</a></li></ul><ul><li><a href=#context>Context</a><ul><li><a href=#een-aantal-uitdagingen>Een aantal uitdagingen</a></li><li><a href=#doel>Doel</a></li></ul></li><li><a href=#functioneel-overzicht>Functioneel overzicht</a><ul><li><a href=#inleiding>Inleiding</a></li><li><a href=#overzicht>Overzicht</a><ul><li><a href=#kernfunctionaliteiten-in-het-kort>Kernfunctionaliteiten in het kort:</a></li><li><a href=#belangrijkste-processen-en-informatiestromen>Belangrijkste processen en informatiestromen:</a></li></ul></li><li><a href=#inleiding-1>Inleiding</a></li><li><a href=#overzicht-1>Overzicht</a><ul><li><a href=#beveiliging--privacy>Beveiliging & Privacy</a></li><li><a href=#beschikbaarheid--continuïteit>Beschikbaarheid & Continuïteit</a></li><li><a href=#performance--schaalbaarheid>Performance & Schaalbaarheid</a></li><li><a href=#auditability--logging-ldv>Auditability & Logging (LDV)</a></li><li><a href=#interoperabiliteit--open-standaarden>Interoperabiliteit & Open Standaarden</a></li><li><a href=#observeerbaarheid>Observeerbaarheid</a></li><li><a href=#herstelbaarheid-back-uprestore-dr>Herstelbaarheid (Back-up/Restore, DR)</a></li></ul></li><li><a href=#buiten-scope--expliciete-uitsluitingen>Buiten scope / expliciete uitsluitingen</a></li><li><a href=#meting-en-borging>Meting en borging</a></li></ul></li><li><a href=#beperkingen>Beperkingen</a><ul><li><a href=#inleiding-2>Inleiding</a></li><li><a href=#overzicht-2>Overzicht</a><ul><li><a href=#organisatorische-en-tijdbudget-beperkingen>Organisatorische en tijd/budget beperkingen</a></li><li><a href=#identiteit-authenticatie-en-autorisatie>Identiteit, authenticatie en autorisatie</a></li><li><a href=#juridisch-en-compliance>Juridisch en compliance</a></li><li><a href=#technologiestack-en-standaarden>Technologiestack en standaarden</a></li><li><a href=#integraties-en-afhankelijkheden>Integraties en afhankelijkheden</a></li><li><a href=#deploy--en-hostingkader>Deploy- en hostingkader</a></li><li><a href=#ontwikkelproces-en-team>Ontwikkelproces en team</a></li><li><a href=#data-en-migratie>Data en migratie</a></li></ul></li><li><a href=#waarom-deze-beperkingen-ertoe-doen>Waarom deze beperkingen ertoe doen</a></li><li><a href=#verwijzingen>Verwijzingen</a></li></ul></li><li><a href=#design-principes>Design Principes</a><ul><li><a href=#inleiding-3>Inleiding</a></li><li><a href=#principes>Principes</a></li></ul></li><li><a href=#software-architectuur>Software architectuur</a><ul><li><a href=#systeem-landschap-diagram>Systeem Landschap diagram</a></li><li><a href=#systeem-container-diagram>Systeem Container diagram</a></li></ul></li><li><a href=#code>Code</a><ul><li><a href=#profiel-beheren>Profiel Beheren</a><ul><li><a href=#profiel-bekijken>Profiel bekijken</a></li><li><a href=#email-updaten--verifiëren>Email updaten & verifiëren</a></li></ul></li><li><a href=#authenticatie>Authenticatie</a></li><li><a href=#digid>DigiD</a></li><li><a href=#eherkenning>eHerkenning</a></li><li><a href=#eidas>eIDas</a><ul><li><a href=#persoon>Persoon</a></li><li><a href=#organisatie>Organisatie</a></li><li><a href=#regels>Regels</a></li></ul></li></ul></li><li><a href=#data>Data</a><ul><li><a href=#gegevensmodel>Gegevensmodel</a><ul><li><a href=#partij>PARTIJ</a></li><li><a href=#contactgegeven>CONTACTGEGEVEN</a></li><li><a href=#identificatie>IDENTIFICATIE</a></li><li><a href=#voorkeur>VOORKEUR</a></li><li><a href=#dienstverlener>DIENSTVERLENER</a></li><li><a href=#dienst>DIENST</a></li><li><a href=#data-transfer-object-dto>Data Transfer Object (DTO)</a></li></ul></li><li><a href=#sequentiediagrammen>Sequentiediagrammen</a></li></ul></li><li><a href=#deployment>Deployment</a><ul><li><a href=#view>View</a></li><li><a href=#omgeving>Omgeving</a><ul><li><a href=#broncode>Broncode</a></li></ul></li></ul></li><li><a href=#beheer-en-support>Beheer en Support</a><ul><li><a href=#hosting-standaard-platform>Hosting Standaard Platform</a></li><li><a href=#benodigde-accounts>Benodigde accounts</a></li></ul></li></ul></nav></aside></main><footer><p class=tagline>Eén Overheid. Voor iedereen!</p><nav aria-label="Footer navigatie"><h2>Over deze site</h2><ul><li><a href=/moza-site/preview/pr-34/privacy/>Privacy</a></li><li><a href=/moza-site/preview/pr-34/toegankelijkheid/>Toegankelijkheid</a></li></ul></nav></footer><dialog id=search-modal class=search-modal aria-label=Zoeken data-search-index=/moza-site/preview/pr-34/index.json><div class=search-modal-content><div class=search-modal-header><svg class="search-icon" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M9 3.5a5.5 5.5.0 100 11 5.5 5.5.0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75.0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"/></svg><input type=search id=search-input class=search-input placeholder=Zoeken... aria-label="Zoek op de website" autocomplete=off autofocus>
<button class=button-ghost id=search-close aria-label=Sluiten><svg class="x-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/></svg></button></div><div class=search-filters role=group aria-label="Filter op sectie"><button class="search-filter active" data-section aria-pressed=true>Alles</button>
<button class=search-filter data-section=weekly aria-pressed=false>MOZa Weekly</button>
<button class=search-filter data-section=onderwerpen aria-pressed=false>Onderwerpen</button>
<button class=search-filter data-section=presentaties aria-pressed=false>Presentaties</button></div><ul id=search-results class=search-results aria-label=Zoekresultaten aria-live=polite></ul></div></dialog><button id=highlight-bar class=toast aria-live=polite hidden>
Zoekterm "<span id=highlight-bar-query></span>" is gemarkeerd. Klik hier om de markering te verwijderen.
</button>
<script src=/moza-site/preview/pr-34/js/toc.317ebb0b1691c91a41375bd45b952fdd.js></script></body></html>